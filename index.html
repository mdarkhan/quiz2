<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>‡¶Ü‡¶∞‡¶¨ ‡¶ú‡¶æ‡¶§‡¶ø‡¶ó‡ßã‡¶∑‡ßç‡¶†‡ßÄ ‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§‡¶ø</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Noto Sans Bengali',sans-serif;
  background:#f8fafc;
  overflow:hidden;
  color:#1e293b;
}

/* HEADER */
header{
  position:absolute;
  top:0;left:0;right:0;
  z-index:20;
  background:#ffffffee;
  border-bottom:1px solid #e5e7eb;
  padding:12px 24px;
}
header h1{margin:0;font-size:20px}
header p{margin:2px 0 0;font-size:12px;color:#64748b}

/* CANVAS */
#container{
  position:absolute;
  inset:0;
  cursor:grab;
}
#container.dragging{cursor:grabbing}

#canvas{
  position:absolute;
  transform-origin:0 0;
}

svg{
  position:absolute;
  left:0;top:0;
  overflow:visible;
}

/* NODE */
.node{
  position:absolute;
  width:150px;
  height:65px;
  padding:6px;
  border-radius:8px;
  border:2px solid;
  text-align:center;
  font-size:13px;
  font-weight:600;
  cursor:pointer;
  transition:.25s;
  box-shadow:0 2px 6px rgba(0,0,0,.15);
}
.node:hover{
  transform:scale(1.12);
  z-index:50;
  background:#f59e0b!important;
  border-color:#f59e0b!important;
  color:white!important;
}
.node.prophet{
  box-shadow:0 0 22px rgba(16,185,129,.7);
}

/* DRAWER */
#drawer{
  position:absolute;
  top:0;right:0;bottom:0;
  width:360px;
  background:white;
  border-left:1px solid #e5e7eb;
  box-shadow:-8px 0 24px rgba(0,0,0,.2);
  display:none;
  flex-direction:column;
  z-index:30;
}
#drawer header{
  background:#047857;
  color:white;
  padding:12px;
}
#drawer .content{
  padding:16px;
  overflow:auto;
}
.badge{
  display:inline-block;
  background:#f1f5f9;
  border:1px solid #e2e8f0;
  border-radius:999px;
  padding:4px 10px;
  font-size:12px;
  margin:4px;
}
</style>
</head>

<body>

<header>
  <h1>‡¶Ü‡¶∞‡¶¨ ‡¶ú‡¶æ‡¶§‡¶ø‡¶ó‡ßã‡¶∑‡ßç‡¶†‡ßÄ ‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§‡¶ø</h1>
  <p>PDF ‡¶∏‡ßã‡¶∞‡ßç‡¶∏ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡¶Ç‡¶∂‡¶≤‡¶§‡¶ø‡¶ï‡¶æ</p>
</header>

  <div style="
  position:absolute;
  top:64px;
  left:16px;
  z-index:30;
  background:white;
  padding:8px;
  border-radius:8px;
  box-shadow:0 4px 12px rgba(0,0,0,.15)
">
  <input
    id="searchBox"
    placeholder="‡¶®‡¶æ‡¶Æ ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‚Ä¶"
    style="width:220px;padding:6px 10px;font-size:14px"
  />
</div>
  
<div id="container">
  <div id="canvas"></div>
</div>

<div id="drawer">
  <header>
    <button onclick="closeDrawer()" style="float:right;background:none;border:none;color:white;font-size:18px">‚úï</button>
    <h3 id="dTitle"></h3>
  </header>
  <div class="content">
    <p id="dInfo"></p>
    <div id="dChildren"></div>
  </div>
</div>

<script>
/* ================= FULL ORIGINAL DATA (UNCHANGED) ================= */
const rawData = {
  id: "root",
  name: "‡¶Ü‡¶∞‡¶¨ ‡¶ú‡¶æ‡¶§‡¶ø‡¶ó‡ßã‡¶∑‡ßç‡¶†‡ßÄ",
  type: "root",
  details: {
    info: "‡¶ê‡¶§‡¶ø‡¶π‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡ßÇ‡¶§‡ßç‡¶∞ ‡¶Æ‡¶§‡ßá, ‡¶¨‡¶Ç‡¶∂ ‡¶™‡¶∞‡¶ø‡¶ï‡ßç‡¶∞‡¶Æ‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶æ‡¶∞‡ßá ‡¶∏‡¶Æ‡¶ó‡ßç‡¶∞ ‡¶Ü‡¶∞‡¶¨ ‡¶ú‡¶æ‡¶§‡¶ø ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶®‡¶§ ‡¶§‡¶ø‡¶® ‡¶≠‡¶æ‡¶ó‡ßá ‡¶¨‡¶ø‡¶≠‡¶ï‡ßç‡¶§‡•§ ‡¶Ü‡¶∞‡¶¨‡ßá‡¶∞ ‡¶≠‡ßå‡¶ó‡ßã‡¶≤‡¶ø‡¶ï ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶∏‡¶æ‡¶ó‡¶∞ ‡¶ì ‡¶™‡¶æ‡¶π‡¶æ‡ßú ‡¶¨‡ßá‡¶∑‡ßç‡¶ü‡¶ø‡¶§ ‡¶è‡¶ï ‡¶™‡ßç‡¶∞‡¶æ‡¶ï‡ßÉ‡¶§‡¶ø‡¶ï ‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡•§",
    location: "‡¶Ü‡¶∞‡¶¨ ‡¶â‡¶™‡¶¶‡ßç‡¶¨‡ßÄ‡¶™ (‡ßß‡ß¶-‡ßß‡ß© ‡¶≤‡¶ï‡ßç‡¶∑ ‡¶¨‡¶∞‡ßç‡¶ó‡¶Æ‡¶æ‡¶á‡¶≤)"
  },
  children: [
    {
      id: "bayidah",
      name: "‡¶Ü‡¶∞‡¶¨‡ßá ‡¶¨‡¶æ‡ßü‡¶ø‡¶¶‡¶æ‡¶π",
      type: "bayidah",
      details: {
        info: "‡¶è‡¶∞‡¶æ ‡¶π‡¶≤‡ßã ‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßÄ‡¶® ‡¶Ü‡¶∞‡¶¨ ‡¶ú‡¶æ‡¶§‡¶ø‡•§ ‡¶ß‡¶∞‡¶æ‡¶™‡ßÉ‡¶∑‡ßç‡¶† ‡¶π‡¶§‡ßá ‡¶è‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶∏‡ßç‡¶§‡¶ø‡¶§‡ßç‡¶¨ ‡¶™‡ßç‡¶∞‡¶æ‡ßü ‡¶®‡¶ø‡¶É‡¶∂‡ßá‡¶∑ ‡¶π‡ßü‡ßá ‡¶ó‡¶ø‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏‡ßá‡¶∞ ‡¶™‡¶æ‡¶§‡¶æ‡ßü ‡¶è‡¶¶‡ßá‡¶∞ ‡¶ñ‡ßÅ‡¶¨ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü ‡¶®‡¶æ‡•§"
      },
      children: [
        { name: "‡¶Ü‡¶¶", type: "bayidah", details: { info: "‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßÄ‡¶® ‡¶ß‡¶Ç‡¶∏‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶ú‡¶æ‡¶§‡¶ø‡•§" } },
        { name: "‡¶õ‡¶æ‡¶Æ‡ßÅ‡¶¶", type: "bayidah", details: { info: "‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßÄ‡¶® ‡¶ß‡¶Ç‡¶∏‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶ú‡¶æ‡¶§‡¶ø‡•§" } },
        { name: "‡¶Ü‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ", type: "bayidah" },
        { name: "‡¶ú‡ßÅ‡¶∞‡¶π‡ßÅ‡¶Æ (‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßÄ‡¶®)", type: "bayidah", details: { info: "‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßÄ‡¶® ‡¶ú‡ßÅ‡¶∞‡¶π‡ßÅ‡¶Æ ‡¶ó‡ßã‡¶§‡ßç‡¶∞‡•§" } },
        { name: "‡¶π‡¶æ‡¶ú‡¶∞‡¶æ ‡¶Æ‡¶æ‡¶â‡¶§", type: "bayidah", details: { location: "‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ ‡¶Ü‡¶∞‡¶¨" } }
      ]
    },
    {
      id: "ariba",
      name: "‡¶Ü‡¶∞‡¶¨‡ßá ‡¶Ü‡¶∞‡¶ø‡¶¨‡¶æ",
      type: "ariba",
      details: {
        info: "‡¶è‡¶∞‡¶æ ‡¶ï‡¶æ‡¶π‡¶§‡¶æ‡¶®‡¶ø ‡¶Ü‡¶∞‡¶¨‡•§ ‡¶Æ‡ßÇ‡¶≤ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶á‡ßü‡¶æ‡¶Æ‡¶æ‡¶® (‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ ‡¶Ü‡¶∞‡¶¨)‡•§",
        location: "‡¶á‡ßü‡¶æ‡¶Æ‡¶æ‡¶®"
      },
      children: [
        {
          name: "‡¶ï‡¶æ‡¶π‡¶§‡¶æ‡¶®",
          type: "ariba",
          children: [
            {
              name: "‡¶á‡ßü‡¶æ‡¶∞‡ßÅ‡¶¨",
              type: "ariba",
              children: [
                {
                  name: "‡¶á‡ßü‡¶æ‡¶∂‡¶ú‡ßÅ‡¶¨",
                  type: "ariba",
                  children: [
                    {
                      name: "‡¶∏‡¶æ‡¶¨‡¶æ",
                      type: "ariba",
                      details: { info: "‡¶™‡ßç‡¶∞‡¶æ‡¶ö‡ßÄ‡¶® ‡¶á‡ßü‡¶æ‡¶Æ‡¶æ‡¶® ‡¶∞‡¶æ‡¶ú‡ßç‡¶Ø‡ßá‡¶∞ ‡¶∞‡¶æ‡¶ú‡¶ß‡¶æ‡¶®‡ßÄ ‡¶è‡¶Å‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßá‡¶á‡•§ ‡¶∞‡¶æ‡¶®‡ßÄ ‡¶¨‡¶ø‡¶≤‡¶ï‡¶ø‡¶∏ ‡¶è‡¶á ‡¶¨‡¶Ç‡¶∂‡ßá‡¶∞‡•§" },
                      children: [
                        {
                          name: "‡¶π‡¶ø‡¶Æ‡ßü‡¶æ‡¶∞",
                          type: "ariba",
                          children: [
                            { name: "‡¶Ø‡¶æ‡¶á‡¶¶‡ßÅ‡¶≤ ‡¶ú‡ßÅ‡¶∞‡¶π‡ßÅ‡¶Æ", type: "ariba" },
                            { name: "‡¶ï‡ßÅ‡¶ú'‡¶Ü", type: "ariba" },
                            { name: "‡¶∏‡¶æ‡¶ï‡¶æ‡¶∏‡¶ø‡¶ï", type: "ariba" }
                          ]
                        },
                        {
                          name: "‡¶ï‡¶æ‡¶π‡¶≤‡¶æ‡¶®",
                          type: "ariba",
                          children: [
                            {
                              name: "‡¶Ü‡¶Ø‡¶¶",
                              type: "ariba",
                              children: [
                                {
                                  name: " ‡¶Ü‡¶Æ‡¶∞ ‡¶Ü‡¶≤ ‡¶Æ‡ßÅ‡¶Ø‡¶æ‡¶á‡¶ï‡¶ø‡ßü‡¶æ",
                                  type: "ariba",
                                  children: [
                                    {
                                      name: "‡¶∏‡¶æ'‡¶≤‡¶æ‡¶¨‡¶æ",
                                      type: "ariba",
                                      children: [
                                        {
                                          name: "‡¶π‡¶æ‡¶∞‡¶ø‡¶∏‡¶æ",
                                          type: "ariba",
                                          children: [
                                            { name: "‡¶Ü‡¶â‡¶∏", type: "ariba" },
                                            { name: "‡¶ñ‡¶æ‡¶Ø‡¶∞‡¶æ‡¶ú", type: "ariba" }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      name: "‡¶π‡¶æ‡¶∞‡¶ø‡¶∏‡¶æ (‡¶ñ‡ßÅ‡¶Ø‡¶æ'‡¶Ü)",
                                      type: "ariba",
                                      children: [
                                        { 
                                          name: "‡¶≤‡ßÅ‡¶π‡¶æ‡¶á", 
                                          type: "ariba",
                                          children: [
                                            { 
                                              name: "‡¶Ü‡¶Æ‡¶∞", 
                                              type: "ariba",
                                              details: { info: "‡¶§‡¶ø‡¶®‡¶ø ‡¶∏‡¶∞‡ßç‡¶¨‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Æ‡¶ï‡ßç‡¶ï‡¶æ‡ßü ‡¶Æ‡ßÇ‡¶∞‡ßç‡¶§‡¶ø‡¶™‡ßÇ‡¶ú‡¶æ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßá‡¶®‡•§" }
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    { name: "‡¶á‡¶Æ‡¶∞‡¶æ‡¶®", type: "ariba", children: [{ name: "‡¶Ü‡¶Ø‡¶¶‡ßá ‡¶ì‡¶Æ‡¶æ‡¶®‡¶ø", type: "ariba" }] },
                                    { name: "‡¶ú‡¶æ‡¶´‡¶®‡¶æ", type: "ariba", children: [{ name: "‡¶ó‡¶æ‡¶∏‡¶∏‡¶æ‡¶® ‡¶ó‡ßã‡¶§‡ßç‡¶∞", type: "ariba" }] }
                                  ]
                                }
                              ]
                            },
                            { name: "‡¶≤‡¶æ‡¶ñ‡¶Æ", type: "ariba" },
                            { name: "‡¶§‡¶æ‡¶à", type: "ariba" },
                            { name: "‡¶ï‡¶ø‡¶®‡¶¶‡¶æ", type: "ariba" }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  name: "‡¶ú‡ßÅ‡¶∞‡¶π‡ßÅ‡¶Æ (‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡ßü)",
                  type: "ariba",
                  details: { info: "‡¶Æ‡¶ï‡ßç‡¶ï‡¶æ‡ßü ‡¶¨‡¶∏‡¶¨‡¶æ‡¶∏ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßá‡¶®‡•§ ‡¶á‡¶∏‡¶Æ‡¶æ‡¶à‡¶≤ (‡¶Ü.) ‡¶è‡¶Å‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶∂‡ßá‡¶ñ‡ßá‡¶®‡•§" }
                }
              ]
            }
          ]
        }
      ]
    },
    {
      id: "mustariba",
      name: "‡¶Ü‡¶∞‡¶¨‡ßá ‡¶Æ‡ßÅ‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ",
      type: "mustariba",
      details: {
        info: "‡¶è‡¶∞‡¶æ ‡¶á‡¶∏‡¶Æ‡¶æ‡¶à‡¶≤ ‡¶¨‡¶ø‡¶® ‡¶á‡¶¨‡ßç‡¶∞‡¶æ‡¶π‡¶ø‡¶Æ (‡¶Ü.) ‡¶è‡¶∞ ‡¶¨‡¶Ç‡¶∂‡¶ß‡¶æ‡¶∞‡¶æ‡•§ ‡¶è‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶¶‡¶®‡¶æ‡¶®‡¶ø ‡¶Ü‡¶∞‡¶¨‡¶ì ‡¶¨‡¶≤‡¶æ ‡¶π‡ßü."
      },
      children: [
        {
          name: "‡¶á‡¶¨‡ßç‡¶∞‡¶æ‡¶π‡¶ø‡¶Æ (‡¶Ü.)",
          type: "prophet-ancestor",
          children: [
            {
              name: "‡¶á‡¶∏‡¶Æ‡¶æ‡¶à‡¶≤ (‡¶Ü.)",
              type: "prophet-ancestor",
              children: [
                { name: "‡¶®‡¶æ‡¶¨‡¶ø‡¶§", type: "mustariba" },
                {
                  name: "‡¶ï‡¶æ‡¶á‡¶¶‡¶æ‡¶∞",
                  type: "prophet-line",
                  children: [
                    {
                      id: "gap-ismail-adnan",
                      name: "‡ß™‡ß¶+ ‡¶™‡ßç‡¶∞‡¶ú‡¶®‡ßç‡¶Æ‡ßá‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶ß‡¶æ‡¶®",
                      type: "gap-green",
                      children: [
                        {
                          name: "‡¶Ü‡¶¶‡¶®‡¶æ‡¶®",
                          type: "prophet-line",
                          children: [
                            {
                              name: "‡¶Æ‡¶æ'‡¶Ü‡¶¶",
                              type: "prophet-line",
                              children: [
                                {
                                  name: "‡¶®‡¶æ‡¶Ø‡¶æ‡¶∞",
                                  type: "prophet-line",
                                  children: [
                                    { name: "‡¶á‡ßü‡¶æ‡¶¶", type: "mustariba" },
                                    { name: "‡¶Ü‡¶®‡¶Æ‡¶æ‡¶∞", type: "mustariba" },
                                    {
                                      name: "‡¶∞‡¶¨‡¶ø'‡¶Ü",
                                      type: "mustariba",
                                      children: [
                                        { 
                                          name: "‡¶Ü‡¶∏‡¶æ‡¶¶", 
                                          type: "mustariba",
                                          children: [
                                            { name: "‡¶Ü‡¶®‡¶Ø‡¶æ‡¶π", type: "mustariba" },
                                            { 
                                              name: "‡¶ú‡¶æ‡¶≤‡ßÄ‡¶¶‡¶æ‡¶π", 
                                              type: "mustariba",
                                              children: [
                                                { name: "‡¶¨‡¶®‡ßÅ ‡¶Ü‡¶¨‡ßç‡¶¶‡ßá ‡¶ï‡¶æ‡ßü‡ßá‡¶∏", type: "mustariba" },
                                                { 
                                                  name: "‡¶¨‡¶®‡ßÅ ‡¶ì‡ßü‡¶æ‡ßü‡¶ø‡¶≤", 
                                                  type: "mustariba",
                                                  children: [
                                                    { name: "‡¶¨‡¶®‡ßÅ ‡¶§‡¶æ‡¶ó‡¶≤‡¶ø‡¶¨", type: "mustariba" },
                                                    { 
                                                      name: "‡¶¨‡¶®‡ßÅ ‡¶¨‡¶ï‡¶∞", 
                                                      type: "mustariba",
                                                      children: [{ name: "‡¶¨‡¶®‡ßÅ ‡¶π‡¶æ‡¶®‡¶ø‡¶´‡¶æ", type: "mustariba" }]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      name: "‡¶Æ‡ßÅ‡¶¶‡¶æ‡¶∞",
                                      type: "prophet-line",
                                      children: [
                                        { name: "‡¶ï‡¶æ‡¶á‡¶∏ ‡¶Ü‡¶á‡¶≤‡¶æ‡¶®", type: "mustariba" },
                                        {
                                          name: "‡¶á‡¶≤‡¶ø‡ßü‡¶æ‡¶∏",
                                          type: "prophet-line",
                                          children: [
                                            {
                                              name: "‡¶Æ‡ßÅ‡¶¶‡¶∞‡¶ø‡¶ï‡¶æ",
                                              type: "prophet-line",
                                              children: [
                                                {
                                                  name: "‡¶ñ‡ßÅ‡¶Ø‡¶æ‡¶á‡¶Æ‡¶æ",
                                                  type: "prophet-line",
                                                  children: [
                                                    {
                                                      name: "‡¶Ü‡¶∏‡¶æ‡¶¶",
                                                      type: "prophet-line",
                                                      children: [
                                                        {
                                                          name: "‡¶ï‡¶ø‡¶®‡¶æ‡¶®‡¶æ‡¶π (‡¶ï‡ßÅ‡¶∞‡¶æ‡¶á‡¶∂)",
                                                          type: "prophet-line",
                                                          children: [
                                                            {
                                                              name: "‡¶Ü‡¶®-‡¶®‡¶æ‡¶¶‡¶∞",
                                                              type: "prophet-line",
                                                              children: [
                                                                {
                                                                  name: "‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï",
                                                                  type: "prophet-line",
                                                                  children: [
                                                                    {
                                                                      name: "‡¶´‡¶ø‡¶π‡¶∞ (‡¶ï‡ßÅ‡¶∞‡¶æ‡¶á‡¶∂)",
                                                                      type: "prophet-line",
                                                                      children: [
                                                                        {
                                                                          name: "‡¶ó‡¶æ‡¶≤‡¶ø‡¶¨",
                                                                          type: "prophet-line",
                                                                          children: [
                                                                            {
                                                                              name: "‡¶≤‡ßÅ‡¶ì‡ßü‡¶æ‡¶á",
                                                                              type: "prophet-line",
                                                                              children: [
                                                                                {
                                                                                  name: "‡¶ï‡¶æ'‡¶Ü‡¶¨",
                                                                                  type: "prophet-line",
                                                                                  children: [
                                                                                    {
                                                                                      name: "‡¶Æ‡ßÅ‡¶∞‡¶∞‡¶æ",
                                                                                      type: "prophet-line",
                                                                                      children: [
                                                                                        {
                                                                                          name: "‡¶á‡¶Ø‡¶º‡¶æ‡¶ï‡¶æ‡¶ú",
                                                                                          type: "mustariba",
                                                                                          children: [{ name: "‡¶¨‡¶®‡ßÅ ‡¶Æ‡¶æ‡¶ñ‡¶ú‡ßÅ‡¶Æ", type: "mustariba", children: [{ name: "‡¶Ü‡¶¨‡ßÅ ‡¶ú‡¶æ‡¶π‡¶≤", type: "mustariba" }] }]
                                                                                        },
                                                                                        {
                                                                                          name: "‡¶ï‡¶ø‡¶≤‡¶æ‡¶¨",
                                                                                          type: "prophet-line",
                                                                                          children: [
                                                                                            {
                                                                                              name: "‡¶Ø‡ßÅ‡¶π‡¶∞‡¶æ",
                                                                                              type: "mustariba",
                                                                                              details: { info: "‡¶¨‡¶®‡ßÄ ‡¶Ø‡ßÅ‡¶π‡¶∞‡¶æ ‡¶ó‡ßã‡¶§‡ßç‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶§‡¶æ‡•§ ‡¶®‡¶¨‡ßÄ‡¶ú‡¶ø‡¶∞ ‡¶Æ‡¶æ‡¶§‡ßÉ‡¶ï‡ßÅ‡¶≤‡•§" },
                                                                                              children: [
                                                                                                {
                                                                                                  name: "‡¶Ü‡¶¨‡ßç‡¶¶‡ßá ‡¶Æ‡¶æ‡¶®‡¶æ‡¶´",
                                                                                                  type: "mustariba",
                                                                                                  children: [
                                                                                                    {
                                                                                                      name: "‡¶ì‡¶Ø‡¶º‡¶æ‡¶π‡¶π‡¶æ‡¶¨",
                                                                                                      type: "mustariba",
                                                                                                      children: [{ name: "‡¶Ü‡¶Æ‡ßá‡¶®‡¶æ", type: "mustariba", details: { info: "‡¶®‡¶¨‡ßÄ‡¶ú‡¶ø (‡¶∏‡¶æ.)-‡¶è‡¶∞ ‡¶∞‡¶§‡ßç‡¶®‡¶ó‡¶∞‡ßç‡¶≠‡¶æ ‡¶Æ‡¶æ‡¶§‡¶æ‡•§" } }]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            },
                                                                                            {
                                                                                              name: "‡¶ï‡ßÅ‡¶∏‡¶æ‡¶á",
                                                                                              type: "prophet-line",
                                                                                              children: [
                                                                                                { name: "‡¶Ü‡¶¨‡ßç‡¶¶‡ßÅ‡¶¶ ‡¶¶‡¶æ‡¶∞", type: "mustariba" },
                                                                                                { name: "‡¶Ü‡¶¨‡ßç‡¶¶", type: "mustariba" },
                                                                                                { 
                                                                                                  name: "‡¶Ü‡¶¨‡ßç‡¶¶‡ßÅ‡¶≤ ‡¶â‡¶ú‡ßç‡¶ú‡¶æ", 
                                                                                                  type: "mustariba", 
                                                                                                  children: [
                                                                                                    { 
                                                                                                      name: "‡¶Ü‡¶∏‡¶æ‡¶¶", 
                                                                                                      type: "mustariba", 
                                                                                                      children: [
                                                                                                        { 
                                                                                                          name: "‡¶ñ‡ßÅ‡¶ì‡ßü‡¶æ‡¶á‡¶≤‡¶ø‡¶¶", 
                                                                                                          type: "mustariba", 
                                                                                                          children: [{name: "‡¶ñ‡¶æ‡¶¶‡¶ø‡¶ú‡¶æ (‡¶∞‡¶æ‡¶É)", type: "mustariba"}] 
                                                                                                        },
                                                                                                        { name: "‡¶®‡¶ì‡¶´‡ßá‡¶≤", type: "mustariba" }
                                                                                                      ] 
                                                                                                    }
                                                                                                  ] 
                                                                                                },
                                                                                                { 
                                                                                                  name: "‡¶Ü‡¶¨‡ßç‡¶¶‡ßá ‡¶Æ‡¶æ‡¶®‡¶æ‡¶´", 
                                                                                                  type: "prophet-line", 
                                                                                                  children: [
                                                                                                    { name: "‡¶®‡¶ì‡¶´‡ßá‡¶≤", type: "mustariba" },
                                                                                                    { name: "‡¶Æ‡ßÅ‡¶§‡ßç‡¶§‡¶æ‡¶≤‡¶ø‡¶¨", type: "mustariba" },
                                                                                                    { 
                                                                                                      name: "‡¶Ü‡¶¨‡ßç‡¶¶‡ßá ‡¶∂‡¶æ‡¶Æ‡¶∏", 
                                                                                                      type: "mustariba",
                                                                                                      children: [
                                                                                                        { 
                                                                                                          name: "‡¶â‡¶Æ‡¶æ‡¶á‡ßü‡¶æ", 
                                                                                                          type: "mustariba", 
                                                                                                          children: [
                                                                                                            { 
                                                                                                              name: "‡¶Ü‡¶¨‡ßÅ‡¶≤ ‡¶Ü‡¶∏", 
                                                                                                              type: "mustariba", 
                                                                                                              children: [{ name: "‡¶Ü‡¶´‡¶´‡¶æ‡¶®" }, { name: "‡¶π‡¶æ‡¶ï‡¶æ‡¶Æ" }] 
                                                                                                            },
                                                                                                            { 
                                                                                                              name: "‡¶π‡¶æ‡¶∞‡¶¨", 
                                                                                                              type: "mustariba", 
                                                                                                              children: [{ name: "‡¶Ü‡¶¨‡ßÅ ‡¶∏‡ßÅ‡¶´‡¶ø‡¶Ø‡¶º‡¶æ‡¶®" }] 
                                                                                                            }
                                                                                                          ] 
                                                                                                        }
                                                                                                      ] 
                                                                                                    },
                                                                                                    { 
                                                                                                      name: "‡¶π‡¶æ‡¶∂‡¶ø‡¶Æ", 
                                                                                                      type: "prophet-line", 
                                                                                                      children: [
                                                                                                        { name: "‡¶Ü‡¶¨‡ßç‡¶¶‡ßÅ‡¶≤ ‡¶Æ‡ßÅ‡¶§‡ßç‡¶§‡¶æ‡¶≤‡¶ø‡¶¨", type: "prophet-line", children: [
                                                                                                          { name: "‡¶Ü‡¶¨‡ßç‡¶¶‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π", type: "prophet-line", children: [
                                                                                                            { name: "‡¶Æ‡ßÅ‡¶π‡¶æ‡¶Æ‡ßç‡¶Æ‡¶æ‡¶¶ Ô∑∫", type: "prophet", details: { info: "‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶∞ ‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶®‡¶¨‡ßÄ‡•§" } }
                                                                                                          ] }
                                                                                                        ] }
                                                                                                      ] 
                                                                                                    }
                                                                                                  ] 
                                                                                                }
                                                                                              ] 
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
};
const NODE_W=150,NODE_H=65,V_GAP=100,H_GAP=40;

/* ================= LAYOUT ENGINE ================= */
function layout(node,depth=0){
  node.children=node.children||[];
  const kids=node.children.map(c=>layout(c,depth+1));
  let totalW=NODE_W;
  if(kids.length){
    totalW=kids.reduce((a,c)=>a+c.totalW+H_GAP,0)-H_GAP;
  }
  return {...node,depth,totalW,children:kids};
}
function position(node,x){
  let cx=x;
  node.children.forEach(c=>{
    position(c,cx);
    cx+=c.totalW+H_GAP;
  });
  node.x=x+node.totalW/2-NODE_W/2;
  node.y=node.depth*(NODE_H+V_GAP);
}

/* ================= PROCESS ================= */
const tree=layout(rawData);
position(tree,0);

/* ================= FLATTEN ================= */
const nodes=[],edges=[];
(function walk(n){
  nodes.push(n);
  n.children.forEach(c=>{
    edges.push({a:n,b:c});
    walk(c);
  });
})(tree);

/* ================= BOUNDS ================= */
const minX=Math.min(...nodes.map(n=>n.x))-300;
const minY=Math.min(...nodes.map(n=>n.y))-300;
const maxX=Math.max(...nodes.map(n=>n.x+NODE_W))+300;
const maxY=Math.max(...nodes.map(n=>n.y+NODE_H))+300;

/* ================= CANVAS ================= */
const canvas=document.getElementById("canvas");
canvas.style.width=(maxX-minX)+"px";
canvas.style.height=(maxY-minY)+"px";

/* ================= SVG ================= */
const svg=document.createElementNS("http://www.w3.org/2000/svg","svg");
svg.setAttribute("width",maxX-minX);
svg.setAttribute("height",maxY-minY);
canvas.appendChild(svg);

/* ================= EDGES ================= */
const edgeFrag = document.createDocumentFragment();

edges.forEach(e=>{
  const p = document.createElementNS(svg.namespaceURI,"path");

  const x1 = e.a.x - minX + NODE_W/2;
  const y1 = e.a.y - minY + NODE_H;
  const x2 = e.b.x - minX + NODE_W/2;
  const y2 = e.b.y - minY;

  p.setAttribute(
    "d",
    `M${x1},${y1} C${x1},${y1+60} ${x2},${y2-60} ${x2},${y2}`
  );

  const isGap =
    e.a.type === "gap-green" ||
    e.b.type === "gap-green";

  p.setAttribute("stroke", isGap ? "#6ee7b7" : "#94a3b8");
  p.setAttribute("stroke-width", isGap ? "2" : "2");
  p.setAttribute("fill","none");

  if(isGap){
    p.setAttribute("stroke-dasharray","6 6");
  }

  edgeFrag.appendChild(p);
});

svg.appendChild(edgeFrag);


/* ================= NODES ================= */
const nodeFrag = document.createDocumentFragment();
const nodeMap = new Map();

nodes.forEach(n=>{
  const d = document.createElement("div");
  d.className = "node";

  if(n.type === "prophet") d.classList.add("prophet");

  d.style.left = (n.x - minX) + "px";
  d.style.top  = (n.y - minY) + "px";
  d.style.background = color(n.type);
  d.style.borderColor = color(n.type);

  const icon = iconFor(n.type);
  d.innerHTML = `<div style="font-size:18px">${icon}</div><div>${n.name}</div>`;

  d.onclick = e=>{
    e.stopPropagation();
    openDrawer(n);
  };

  nodeFrag.appendChild(d);
  nodeMap.set(n.name, { node:n, el:d });
});

canvas.appendChild(nodeFrag);

/* ================= PAN + ZOOM ================= */
let scale=.6,ox=300,oy=160,drag=false,sx,sy;
function update(){canvas.style.transform=`translate(${ox}px,${oy}px) scale(${scale})`}
update();

container.onmousedown=e=>{drag=true;container.classList.add("dragging");sx=e.clientX-ox;sy=e.clientY-oy};
container.onmousemove=e=>{if(drag){ox=e.clientX-sx;oy=e.clientY-sy;update()}};
container.onmouseup=()=>{drag=false;container.classList.remove("dragging")};
container.onmouseleave=()=>drag=false;
container.onwheel=e=>{
  e.preventDefault();
  scale=Math.max(.05,Math.min(3,scale-e.deltaY*0.001));
  update();
};
const searchBox = document.getElementById("searchBox");

searchBox.addEventListener("input", ()=>{
  const q = searchBox.value.trim();
  if(!q) return;

  for(const [name,obj] of nodeMap){
    if(name.includes(q)){
      focusNode(obj.el);
      break;
    }
  }
});

function focusNode(el){
  const x = el.offsetLeft;
  const y = el.offsetTop;

  scale = 1.2;
  ox = window.innerWidth/2 - (x + NODE_W/2) * scale;
  oy = window.innerHeight/2 - (y + NODE_H/2) * scale;
  update();

  el.style.boxShadow = "0 0 30px #facc15";
  setTimeout(()=>el.style.boxShadow="",1200);
}

/* ================= DRAWER ================= */
function openDrawer(n){
  drawer.style.display="flex";
  dTitle.textContent=n.name;
  dInfo.textContent=n.details?.info||"‡¶è‡¶á ‡¶®‡ßã‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶§‡¶•‡ßç‡¶Ø ‡¶®‡ßá‡¶á‡•§";
  dChildren.innerHTML="";
  (n.children||[]).forEach(c=>{
    const b=document.createElement("span");
    b.className="badge";
    b.textContent=c.name;
    dChildren.appendChild(b);
  });
}
function closeDrawer(){drawer.style.display="none"}

/* ================= COLOR ================= */
function color(t){
  return {
    root:"#064E3B",
    bayidah:"#9333EA",
    ariba:"#407cde",
    mustariba:"#EA580C",
    prophet:"#047857",
    "prophet-line":"#10b981",
    "prophet-ancestor":"#10b981",
    "gap-green":"#a7f3d0"
  }[t]||"#64748b";
}
function iconFor(type){
  return {
    root:"üïã",
    prophet:"üïå",
    "prophet-line":"üïå",
    "prophet-ancestor":"üïå",
    bayidah:"üèõÔ∏è",
    ariba:"üèõÔ∏è",
    mustariba:"üèõÔ∏è",
    "gap-green":"‚ûñ"
  }[type] || "üë§";
}
</script>

</body>
</html>


